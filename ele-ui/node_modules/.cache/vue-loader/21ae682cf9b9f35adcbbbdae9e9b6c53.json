{"remainingRequest":"/Users/percher/personnel-management-system/ele-ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/percher/personnel-management-system/ele-ui/src/components/Author/Control.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/percher/personnel-management-system/ele-ui/src/components/Author/Control.vue","mtime":1589701422710},{"path":"/Users/percher/personnel-management-system/ele-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/percher/personnel-management-system/ele-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/percher/personnel-management-system/ele-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/percher/personnel-management-system/ele-ui/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKCiAgICAgICAgICAgIHRoaXNfdWlkOiAwLAoKICAgICAgICAgICAgdGFibGVEYXRhOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdWlkOiAyMywKICAgICAgICAgICAgICAgICAgICBkdXR5OiAn5ZGY5belJywKICAgICAgICAgICAgICAgICAgICBhdXRob3I6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ+eOi+Wwj+iZjicsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdCiAgICAgICAgfQogICAgfSwKCiAgICBtZXRob2RzOiB7CiAgICAgICAgdXNlclR5cGUocm93KSB7CiAgICAgICAgICAgIHJldHVybiByb3cuZHV0eSA9IHJvdy5hdXRob3IgPyAn566h55CG5ZGYJyA6ICflkZjlt6UnCiAgICAgICAgfQogICAgICAgICwKICAgICAgICBjaGFuZ2VFdmVudChyb3cpIHsKICAgICAgICAgICAgbGV0IF90aGlzID0gdGhpcwogICAgICAgICAgICBsZXQgbXkgPSBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInVzZXJJbmZvIikpCiAgICAgICAgICAgIGlmIChyb3cuYXV0aG9yKSB7CiAgICAgICAgICAgICAgICByb3cuZHV0eSA9ICLnrqHnkIblkZgiCiAgICAgICAgICAgICAgICAvL2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9sb2dpbi9lZGl0Um9sZS97dWlkfS8xCiAgICAgICAgICAgICAgICAvL+WQkeacjeWKoeWZqOivt+axgnJvdy5pZOWPmOS4uueuoeeQhuWRmAogICAgICAgICAgICAgICAgYXhpb3MucHV0KCJodHRwOi8vbG9jYWxob3N0OjgwODEvbG9naW4vZWRpdFJvbGUvIiArIHJvdy51aWQgKyAiLzEvIgogICAgICAgICAgICAgICAgICAgICsgcm93Lm5hbWUgKyAiLyIgKyBteS51aWQgKyAiLyIgKyBteS5uYW1lKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3AuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJvdy5uYW1lICsgIuW3suaIkOS4uueuoeeQhuWRmCIpCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImVycm9yIikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcm93LmR1dHkgPSAi5ZGY5belIgogICAgICAgICAgICAgICAgLy9odHRwOi8vbG9jYWxob3N0OjgwODEvbG9naW4vZWRpdFJvbGUve3VpZH0vMgogICAgICAgICAgICAgICAgLy/lkJHmnI3liqHlmajmkqTplIByb3cuaWTnmoTnrqHnkIblkZjotYTmoLwKICAgICAgICAgICAgICAgIGF4aW9zLnB1dCgiaHR0cDovL2xvY2FsaG9zdDo4MDgxL2xvZ2luL2VkaXRSb2xlLyIgKyByb3cudWlkICsgIi8yLyIKICAgICAgICAgICAgICAgICAgICArIHJvdy5uYW1lICsgIi8iICsgbXkudWlkICsgIi8iICsgbXkubmFtZSkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuJG1lc3NhZ2UuaW5mbyhyb3cubmFtZSArICLlt7LpmY3nuqfkuLrlkZjlt6UiKQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJlcnJvciIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVkKCkgewogICAgICAgIGxldCBfdGhpcyA9IHRoaXMKICAgICAgICB0aGlzLnRoaXNfdWlkID0gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ1c2VySW5mbyIpKS51aWQKICAgICAgICBheGlvcy5nZXQoImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9sb2dpbi9nZXRSb2xlIikudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgICBfdGhpcy50YWJsZURhdGEgPSByZXNwLmRhdGEKICAgICAgICB9KQogICAgfQp9Cg=="},{"version":3,"sources":["Control.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Control.vue","sourceRoot":"src/components/Author","sourcesContent":["<template>\n    <div>\n\n        <el-table style=\"width: 100%\"\n                  height=\"510\"\n                  :data=\"tableData\">\n            <el-table-column label=\"ID\" prop=\"uid\"></el-table-column>\n            <el-table-column label=\"姓名\" prop=\"name\"></el-table-column>\n            <el-table-column label=\"身份\" prop=\"duty\" :formatter=\"userType\"></el-table-column>\n            <el-table-column label=\"操作\">\n                <template slot-scope=\"scope\">\n                    <el-switch :disabled=\"this_uid===scope.row.uid\" v-model=\"scope.row.author\"\n                               @change=\"changeEvent(scope.row)\"></el-switch>\n                </template>\n            </el-table-column>\n\n        </el-table>\n\n    </div>\n</template>\n\n<script>\n    export default {\n        data() {\n            return {\n\n                this_uid: 0,\n\n                tableData: [\n                    {\n                        uid: 23,\n                        duty: '员工',\n                        author: true,\n                        name: '王小虎',\n                    },\n                ]\n            }\n        },\n\n        methods: {\n            userType(row) {\n                return row.duty = row.author ? '管理员' : '员工'\n            }\n            ,\n            changeEvent(row) {\n                let _this = this\n                let my = JSON.parse(sessionStorage.getItem(\"userInfo\"))\n                if (row.author) {\n                    row.duty = \"管理员\"\n                    //http://localhost:8081/login/editRole/{uid}/1\n                    //向服务器请求row.id变为管理员\n                    axios.put(\"http://localhost:8081/login/editRole/\" + row.uid + \"/1/\"\n                        + row.name + \"/\" + my.uid + \"/\" + my.name).then(function (resp) {\n                        if (resp.data) {\n                            _this.$message.success(row.name + \"已成为管理员\")\n                        } else {\n                            console.log(\"error\")\n                        }\n                    })\n                } else {\n                    row.duty = \"员工\"\n                    //http://localhost:8081/login/editRole/{uid}/2\n                    //向服务器撤销row.id的管理员资格\n                    axios.put(\"http://localhost:8081/login/editRole/\" + row.uid + \"/2/\"\n                        + row.name + \"/\" + my.uid + \"/\" + my.name).then(function (resp) {\n                        if (resp.data) {\n                            _this.$message.info(row.name + \"已降级为员工\")\n                        } else {\n                            console.log(\"error\")\n                        }\n                    })\n                }\n            }\n        },\n        created() {\n            let _this = this\n            this.this_uid = JSON.parse(sessionStorage.getItem(\"userInfo\")).uid\n            axios.get(\"http://localhost:8081/login/getRole\").then(function (resp) {\n                _this.tableData = resp.data\n            })\n        }\n    }\n</script>"]}]}